import {Meta} from '@storybook/addon-docs/blocks';

<Meta title="Examples/Chart Menu/README"/>

# Chart Menu Examples

This page provides various examples of customizing Chart Menu.

<br/>

## Example - Custom menu for sunburst chart

This example shows how to add a menu with custom actions for a sunburst chart.

### Steps

Add a custom renderer for a Sunburst chart to handle 'hovered' setting changes.

```jsx
const SunburstCustomRenderer = (props) => {
        const {
            preferences,
            classes,
            hovered,
            width,
            height,
            padAngle,
            applyStyles,
            valueMouseOverHandler,
            valueMouseOutHandler,
            valueClickHandler,
            hintFormatter,
            data,
        } = props;

        const _hovered = (preferences?.hovered ?? true) && hovered;
        return (
            <Grid item xs={12} className={classes.chart}>
                <Box display="flex" justifyContent="center">
                    <Box>
                        <SunburstVis
                            hideRootNode
                            colorType='literal'
                            width={width}
                            height={height}
                            padAngle={padAngle}
                            data={{children: applyStyles(data)}}
                            onValueMouseOver={valueMouseOverHandler}
                            onValueMouseOut={valueMouseOutHandler}
                            onValueClick={valueClickHandler}
                            style={{margin: '0 auto'}}
                        >
                            {_hovered && <Hint value={_hovered} format={hintFormatter}/>}
                        </SunburstVis>
                    </Box>
                </Box>
            </Grid>
        );
    };
```

Implement custom component which adds setting to enable/disable hover action for a sunburst chart.
Also provide custom chart mapper to use custom settings.

```jsx
 const withSunburstSettings = R.curry((WrappedChart, props) => {
        const sunburstSettings = [
                {name: 'hovered', label: 'Hovered'}
            ];

        const ComposedSunburst = withChartSettings(sunburstSettings)(Sunburst);

        const getChartByType = R.cond([
            [R.equals('sunburst'), R.always(R.pair(ComposedSunburst, sunburstDataReducer(null)))]
        ]);
        return <WrappedChart {...props} getChartByType={getChartByType} ChartRenderer={SunburstCustomRenderer}/>;
    });
```

Implement a custom factory component for the DefaultChartContainer component where we add the custom action into the compose function.

```jsx
    const CustomChartFactory = (props) => {
        const {Component = DefaultChartContainer, ...otherProps} = props;

        const Chart = R.compose(
            withChartConfigLoader,
            withSunburstSettings
        )(Component);

        return (
            <Chart {...otherProps} />
        );
    };
```

Create mapping conditions for the domain components.

```jsx
    const DomainComponentMapping = R.cond([
        [R.propEq('type', 'chart'), CustomChartFactory]
    ]);
```

Implement the domain component factory in the way that the domain component mapping comes first.

```jsx
    const DomainComponentFactory = (props) => DomainComponentMapping(props) || DefaultComponentFactory(props)
```

<br/>

## Example - Remove menu for composite chart

This example shows how to remove a default menu for a composite chart.

### Steps

Implement custom component which removes a default menu for a composite chart.
Add a custom mapper to pass VerticalPlotChart component without settings.

```jsx
 const withoutCompositeChartSettings = R.curry((WrappedChart, props) => {

        const xyFunctor = (x, y) => ({x, y});

        const getChartByType = R.cond([
            [R.equals('vComposite'), R.always(R.pair(VerticalPlotChart, xyPlotDataReducer(xyFunctor, null)))],
        ]);
        return <WrappedChart {...props} getChartByType={getChartByType}/>;
    });
```

Implement a custom factory component for the DefaultChartContainer component where we add the custom action into the compose function.

```jsx
    const CustomChartFactory = (props) => {
        const {Component = DefaultChartContainer, ...otherProps} = props;

        const Chart = R.compose(
            withChartConfigLoader,
            withoutCompositeChartSettings
        )(Component);

        return (
            <Chart {...otherProps} />
        );
    };
```

Create mapping conditions for the domain components.

```jsx
    const DomainComponentMapping = R.cond([
        [R.propEq('type', 'chart'), CustomChartFactory]
    ]);
```

Implement the domain component factory in the way that the domain component mapping comes first.

```jsx
    const DomainComponentFactory = (props) => DomainComponentMapping(props) || DefaultComponentFactory(props)
```
