
import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Templates/Action Factory" />

# Default Action Factory

```jsx
function DefaultActionFactory(defaultSettings = {}) {
	this.createAction = R.curry((action, props) => {
		const {settings = {}, ...otherProps} = props;

		const {view: viewSettings = {}} = settings;

		const ActionComponent = DefaultActionMapper({...defaultSettings, ...viewSettings}, action);

		return <ActionComponent {...otherProps} {...action} action={action}/>;
	});

	this.getFormSubmitHandler = DefaultFormSubmitHandlerMapper;
}
```

### Default Action Mapper

```jsx
const DefaultActionMapper = R.curry((settings = {}, action) => {

	const DefaultAction = R.ifElse(() => action.href, R.always(DefaultToolbarAction), R.always(DefaultRowAction))(action);

	const ViewDocumentAction = withRecentHistoryActionHandler(DocumentViewAction(settings));
	const ViewResourceAction = withRecentHistoryActionHandler(ResourceViewAction(settings));

	return R.cond([
		[D.isCreateCaseAction, R.always(CreateCaseWithAttachments(settings))],
		[D.isCreateDocumentAction, R.always(CreateDocumentAction(settings))],
		[D.isCopyCaseAction, R.always(CopyCaseAction(settings))],
		[D.isAttachNewDocumentAction, R.always(AttachDocumentAction(settings))],
		[D.isAttachExistingDocumentAction, R.always(AttachRepositoryDocumentAction(settings))],
		[D.isCheckInByTypeAction, R.always(CheckInDocTypeAction(settings))],
		[D.isCheckInAction, R.always(CheckInAction(settings))],
		[D.isDocumentViewAction, R.always(ViewDocumentAction)],
		[D.isViewAction, R.always(ViewResourceAction)],
		[D.isCopyLinkAction, R.always(CopyLinkAction(settings))],
		[D.isDispatchAction, R.always(DispatchAction(settings))],
		[D.isReassignAction, R.always(ReassignAction(settings))],
		[D.isLockAction, R.always(LockAction(settings))],
		[D.isUnlockAction, R.always(UnlockAction(settings))],
		[D.isViewContentAction, R.always(DefaultContentAction({contentDisposition: INLINE}))],
		[D.isDownloadContent, R.always(DefaultContentAction({contentDisposition: DOWNLOAD}))],
		[R.T, R.always(DefaultAction)]
	])(action);
});
```

### Definitions (D.*)

```jsx
const isCase = R.propEq('resourceName', "cases");
const isDocument = R.propEq('resourceName', "documents");

const isViewAction = R.anyPass([R.propEq('type', 'view'), R.propEq('type', 'edit')]);
const isDocumentViewAction = R.allPass([isViewAction, isDocument]);
const isCreateCaseAction = R.allPass([R.propEq('type', 'create'), isCase]);
const isCreateDocumentAction = R.allPass([R.propEq('type', 'create'), isDocument]);
const isCopyCaseAction = R.allPass([R.propEq('type', 'copy'), isCase]);
const isAttachNewDocumentAction = R.allPass([R.propEq('type', 'attach'), R.propEq('viewType', 'Create'), isDocument]);
const isAttachExistingDocumentAction = R.allPass([R.propEq('type', 'attach'), R.propEq('viewType', 'Attach'), isDocument]);
const isCheckInAction = R.propEq('type', 'checkin');
const isCheckInByTypeAction = R.allPass([isCheckInAction, R.has("resourceType")]);
const isCopyLinkAction = R.propEq('type', 'copy_link');
const isDispatchAction = R.propEq('type', 'dispatch');
const isReassignAction = R.propEq('type', 'reassign');
const isLockAction = R.propEq('type', 'lock');
const isUnlockAction = R.propEq('type', 'unlock');
const isViewContentAction = R.propEq('type', 'view_content');
const isDownloadContent = R.propEq('type', 'download');
```